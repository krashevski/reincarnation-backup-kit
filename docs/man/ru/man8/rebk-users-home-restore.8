.TH REBK-USERS-HOME-RESTORE 8 "Февраль 2026" "REBK" "Системное администрирование"

.SH NAME
rebk-users-home-restore — восстановление доступа к домашним каталогам пользователей после переустановки Ubuntu

.SH DESCRIPTION
После переустановки Ubuntu или ручного восстановления раздела /home
учётные записи пользователей создаются заново, и каждому пользователю
назначается новый UID.

Домашние каталоги
.BR /home/USERNAME
могут остаться:
.IP \(bu 2
принадлежащими
.B root:root
.IP \(bu 2
принадлежащими старому UID, которого больше не существует.

Система намеренно не изменяет владельцев данных автоматически,
поскольку не может знать, кому именно они принадлежат.

Данный документ описывает безопасную, осознанную и каноническую процедуру
диагностики и восстановления пользовательских домашних каталогов.

.SH SYNOPSIS
.nf
getent passwd USERNAME
ls -ld /home/USERNAME
stat /home/USERNAME

chown -R USERNAME:USERNAME /home/USERNAME
.fi

.SH SYMPTOMS
Типичные признаки проблемы:
.IP \(bu 2
пользователь не может войти в систему
.IP \(bu 2
пустой рабочий стол
.IP \(bu 2
ошибки доступа к файлам
.IP \(bu 2
приложения не сохраняют настройки
.IP \(bu 2
сообщения
.BR "Permission denied"
.IP \(bu 2
сбой восстановления пользовательских данных в REBK

.SH DIAGNOSTICS
Проверка существования пользователя:
.RS
.nf
getent passwd USERNAME
.fi
.RE

Ожидаемый результат:
.RS
.nf
USERNAME:x:1000:1000:...:/home/USERNAME:/bin/bash
.fi
.RE
Обратить внимание на UID и путь к домашнему каталогу.

Проверка владельца каталога:
.RS
.nf
ls -ld /home/USERNAME
.fi
.RE

или

.RS
.nf
stat /home/USERNAME
.fi
.RE

После выполнения команд необходимо сравнить UID пользователя
и владельца каталога.

Типовые проблемные состояния:
.TP
.B root:root
пользователь не имеет доступа к домашнему каталогу
.TP
.B старый\ UID
скрытая несовместимость между учётной записью и владельцем каталога
.TP
.B пустой\ каталог
возможная ошибка монтирования
.BR /home

.SH RECOVERY
.SS "Проверка перед восстановлением"
.IP \(bu 2
пользователь существует
.IP \(bu 2
каталог расположен строго в
.BR /home/USERNAME
.IP \(bu 2
данные действительно принадлежат этому пользователю

.SS "Исправление владельца"
.RS
.nf
chown -R USERNAME:USERNAME /home/USERNAME
.fi
.RE
Команда применяется только точечно.

.SH WARNINGS
Никогда не выполняйте
.BR "chown -R /home" .
Без точной проверки это может привести к необратимой потере данных
и нарушению целостности системы.

.SH SAFETY\ RULES
Любые инструменты или скрипты должны отказываться работать, если:
.IP \(bu 2
имя пользователя
.B root
.IP \(bu 2
каталог не находится в
.BR /home
.IP \(bu 2
пользователь не существует
.IP \(bu 2
путь пуст или выглядит подозрительно

.SH AUTOMATION\ POLICY
Допустимы только два режима автоматизации:
.IP \(bu 2
.B audit
— проверка и отчёт (по умолчанию)
.IP \(bu 2
.B fix
— исправление по явному флагу и подтверждению

Автоматическое исправление без диагностики запрещено.

.SH INTEGRATION
Данная процедура является канонической для Reincarnation Backup Kit (REBK) и используется как:
.IP \(bu 2
основа для скриптов восстановления
.IP \(bu 2
чеклист после переустановки системы
.IP \(bu 2
объяснение архитектурного поведения Ubuntu

.SH NOTES
Переустановка системы — это не потеря данных,
а проверка понимания того, кому они принадлежат.

.SH SEE ALSO
chown(1), stat(1), getent(1), passwd(5)

.PP
.SH AUTHOR
Reincarnation Backup Kit Project

.PP
.SH STATUS
Canonical / Stable
